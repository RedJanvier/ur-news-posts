(this["webpackJsonpreact-playground"]=this["webpackJsonpreact-playground"]||[]).push([[0],{20:function(e,t,a){e.exports=a(38)},25:function(e,t,a){},27:function(e,t,a){},28:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),l=a.n(c),o=a(10),s=a(2),m=(a(25),a(4)),u=a.n(m),i=a(1),p=a(9),d=a(5),E=(a(27),function(e){var t=e.children,a=e.title;return r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"modal__header"},r.a.createElement("h2",null,a)),r.a.createElement("div",{className:"modal__body"},t),r.a.createElement("div",{className:"modal__footer"},"\xa92020 All Rights Reserved"))}),b=function(e,t){switch(t.type){case"LOGIN_USER":case"LOGOUT_USER":return Object(i.a)(Object(i.a)({},e),t.payload);default:return e}},g={token:null,userId:null,regNumber:null,role:null},f=Object(n.createContext)(g),h=function(e){var t=e.children,a=Object(n.useReducer)(b,g),c=Object(d.a)(a,2),l=c[0],o=c[1];return r.a.createElement(f.Provider,{value:{token:l.token,regNumber:l.regNumber,userId:l.userId,role:l.role,login:function(e){o({type:"LOGIN_USER",payload:e}),localStorage.setItem("userData",JSON.stringify(e))},logout:function(){o({type:"LOGOUT_USER",payload:g}),localStorage.removeItem("userData")}}},t)},v=(a(28),function(e){var t=Object(n.useContext)(f).login,a=Object(s.g)(),c=Object(n.useState)({page:"login",name:"",regNumber:0,password:"",audienceLocation:{class:"",campus:"",department:"",school:""}}),l=Object(d.a)(c,2),o=l[0],m=l[1],b="login"===o.page?"register":"login",g=function(){var e=Object(p.a)(u.a.mark((function e(n){var r,c,l,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r="http://localhost:4000/api/v1/users/".concat(o.page),c=Object(i.a)({name:o.name,regNumber:o.regNumber,password:o.password},o.audienceLocation),e.next=5,fetch(r,{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"Application/json"}});case 5:return l=e.sent,e.next=8,l.json();case 8:(s=e.sent).success&&("register"===o.page&&a.push("/"),t(s),a.push("/home"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"auth-page"},r.a.createElement(E,{title:o.page},r.a.createElement("form",{onSubmit:g},"register"===o.page&&r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"username"},"Full Name"),r.a.createElement("input",{type:"text",name:"username",placeholder:"Enter your Full name",onChange:function(e){return m(Object(i.a)(Object(i.a)({},o),{},{name:e.target.value}))},required:!0})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"reg"},"Reg. Number"),r.a.createElement("input",{type:"text",name:"reg",onChange:function(e){return m(Object(i.a)(Object(i.a)({},o),{},{regNumber:parseInt(e.target.value)}))},placeholder:"Enter your RegNumber",required:!0})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",name:"password",placeholder:"Enter your Password",onChange:function(e){return m(Object(i.a)(Object(i.a)({},o),{},{password:e.target.value}))},required:!0})),"register"===o.page&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-control"},r.a.createElement("select",{name:"campus",value:o.audienceLocation.campus,onChange:function(e){return m(Object(i.a)(Object(i.a)({},o),Object.assign(o.audienceLocation,{campus:e.target.value})))},required:!0},r.a.createElement("option",{value:"",disabled:!0},"Select a campus"),r.a.createElement("option",{value:"CST"},"UR CST - Nyarugenge"))),r.a.createElement("div",{className:"form-control"},r.a.createElement("select",{name:"school",value:o.audienceLocation.school,onChange:function(e){return m(Object(i.a)(Object(i.a)({},o),Object.assign(o.audienceLocation,{school:e.target.value})))},required:!0},r.a.createElement("option",{value:"",disabled:!0},"Select your School"),r.a.createElement("option",{value:"ICT"},"School of ICT"),r.a.createElement("option",{value:"MIN"},"School of Mining"),r.a.createElement("option",{value:"SCI"},"School of Science"),r.a.createElement("option",{value:"ENG"},"School of Engineering"),r.a.createElement("option",{value:"ARC"},"School of Architecture"))),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"department"},"Department"),r.a.createElement("input",{type:"text",name:"department",placeholder:"Enter your Department in abbreviations",onChange:function(e){return m(Object(i.a)(Object(i.a)({},o),Object.assign(o.audienceLocation,{department:e.target.value})))},required:!0})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"class"},"Combination"),r.a.createElement("input",{type:"text",name:"class",placeholder:"Enter your Combination in abbreviations",onChange:function(e){return m(Object(i.a)(Object(i.a)({},o),Object.assign(o.audienceLocation,{class:e.target.value})))},required:!0}))),r.a.createElement("div",{className:"form-control"},r.a.createElement("input",{type:"submit",className:"btn",value:o.page}),r.a.createElement("button",{className:"btn-light",onClick:function(){return m(Object(i.a)(Object(i.a)({},o),{},{page:b}))}},b," instead")),"login"===o.page&&r.a.createElement("div",{className:"form-control"},r.a.createElement("input",{type:"checkbox",name:"keepSigned"}),r.a.createElement("label",{htmlFor:"keepSigned"},"Keep me signed in")))))}),O=function(e){var t=e.title,a=e._id,c=e.creator,l=e.img,o=e.description,s=Object(n.useState)({}),m=Object(d.a)(s,2),i=m[0],E=m[1];return Object(n.useEffect)((function(){Object(p.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:4000/api/v1/users/".concat(c));case 3:return t=e.sent,e.next=6,t.json();case 6:if(!(a=e.sent).success){e.next=9;break}return e.abrupt("return",E(a.data));case 9:return e.abrupt("return",console.log(a.data));case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",console.log(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))()}),[]),r.a.createElement("div",{className:"news-post"},r.a.createElement("div",{className:"news-post__header"},r.a.createElement("img",{src:l,alt:"post-hero-".concat(a)}),r.a.createElement("h3",null,t)),r.a.createElement("div",{className:"news-post__body"},r.a.createElement("p",null,o)),r.a.createElement("div",{className:"news-post__footer"},i.name))},j=(a(34),function(e){var t=e.news;return r.a.createElement("div",{className:"news-list"},t.map((function(e){return r.a.createElement(O,Object.assign({key:e._id},e))})))}),N=function(e){var t=Object(n.useContext)(f).token,a=Object(n.useState)([]),c=Object(d.a)(a,2),l=c[0],o=c[1];return Object(n.useEffect)((function(){Object(p.a)(u.a.mark((function e(){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:4000/api/v1/news",{method:"GET",headers:{"Content-Type":"Application/json",Authorization:"Bearer ".concat(t)}});case 3:return a=e.sent,e.next=6,a.json();case 6:(n=e.sent).success&&o(n.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}),[t]),r.a.createElement("div",{className:"home-page"},r.a.createElement(j,{news:l}))},y=(a(35),function(e){e.role;var t=e.token,a=Object(n.useState)({role:"",regNumber:null}),c=Object(d.a)(a,2),l=c[0],o=c[1],s=function(){var e=Object(p.a)(u.a.mark((function e(a){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,n={headers:{"Content-Type":"Application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(l),method:"POST"},e.next=5,fetch("http://localhost:4000/api/v1/users",n);case 5:return r=e.sent,e.next=8,r.json();case 8:c=e.sent,console.log(c.message),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(E,{title:"Update Role"},r.a.createElement("form",{onSubmit:s},r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"reg"},"Reg. Number"),r.a.createElement("input",{type:"text",name:"reg",onChange:function(e){return o(Object(i.a)(Object(i.a)({},l),{},{regNumber:parseInt(e.target.value)}))},placeholder:"Enter your RegNumber",required:!0})),r.a.createElement("div",{className:"form-control"},r.a.createElement("select",{name:"role",value:l.role,onChange:function(e){return o(Object(i.a)(Object(i.a)({},l),{},{role:e.target.value}))},required:!0},r.a.createElement("option",{value:"",disabled:!0},"Select a Role"),r.a.createElement("option",{value:"student"},"Student"),r.a.createElement("option",{value:"staff"},"Staff Member"),r.a.createElement("option",{value:"admin"},"Admin"))),r.a.createElement("div",{className:"form-control"},r.a.createElement("button",{type:"submit",className:"btn"},"Update"))))}),x=function(e){var t=Object(n.useContext)(f),a=t.role,c=t.token;return r.a.createElement("div",{className:"admin-page"},r.a.createElement(y,{role:a,token:c}))},S=(a(36),function(e){var t=Object(n.useContext)(f),a=t.token,c=t.logout,l=t.role;return r.a.createElement("div",{className:"search"},r.a.createElement("div",{className:"logo"},r.a.createElement("h2",null,"UR News Post")),r.a.createElement("div",{className:"navbar__links"},r.a.createElement("ul",null,a?r.a.createElement("li",null,r.a.createElement("button",{className:"otherBtns",onClick:c},"Logout")):r.a.createElement("li",null,r.a.createElement(o.b,{to:"/auth",className:"otherBtns"},"Login")),"admin"===l&&r.a.createElement("li",null,r.a.createElement(o.b,{to:"/admin",className:"otherBtns"},"Admin")),"student"!==l&&r.a.createElement("li",null,r.a.createElement(o.b,{to:"/create",className:"otherBtns"},"Create News")))))}),w=(a(37),function(){return r.a.createElement("div",{className:"spinner"},r.a.createElement("div",{className:"lds-ellipsis"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))}),C=function(e){var t=e.role,a=void 0===t?"student":t,c=e.token,l=Object(s.g)(),o=Object(n.useState)({title:"",target:"",loading:!1,targetType:"",description:""}),m=Object(d.a)(o,2),b=m[0],g=m[1],f=Object(n.useState)({}),h=Object(d.a)(f,2),v=h[0],O=h[1],j=function(){var e=Object(p.a)(u.a.mark((function e(t){var a,n,r,o,s,m,p,d,E;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),g(Object(i.a)(Object(i.a)({},b),{},{loading:!0})),e.prev=2,a=b.title,n=b.description,r=b.target,o=b.targetType,(s=new FormData).append("img",v),s.append("title",a),s.append("target",r),s.append("targetType",o),s.append("description",n),m={body:s,method:"POST",headers:{Authorization:"Bearer ".concat(c)}},e.next=13,fetch("http://localhost:4000/api/v1/news/create",m);case 13:return p=e.sent,e.next=16,p.json();case 16:d=e.sent,E=d.success,g(Object(i.a)(Object(i.a)({},b),{},{loading:!1})),E&&l.push("/home"),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(2),console.log(e.t0),g(Object(i.a)(Object(i.a)({},b),{},{loading:!1}));case 26:case"end":return e.stop()}}),e,null,[[2,22]])})));return function(t){return e.apply(this,arguments)}}();return"student"===a?null:r.a.createElement(E,{title:"Create News"},r.a.createElement("form",{onSubmit:j},r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"title"},"Title"),r.a.createElement("input",{type:"text",name:"title",onChange:function(e){return g(Object(i.a)(Object(i.a)({},b),{},{title:e.target.value}))},placeholder:"News title",required:!0})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"description"},"Description"),r.a.createElement("textarea",{name:"description",onChange:function(e){return g(Object(i.a)(Object(i.a)({},b),{},{description:e.target.value}))},placeholder:"News description",required:!0,rows:"3"})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"image"},"Image"),r.a.createElement("input",{type:"file",name:"image",onChange:function(e){return O(e.target.files[0])},placeholder:"News image",required:!0})),r.a.createElement("div",{className:"form-control"},r.a.createElement("select",{name:"targetType",value:b.targetType,onChange:function(e){return g(Object(i.a)(Object(i.a)({},b),{},{targetType:e.target.value}))},required:!0},r.a.createElement("option",{value:"",disabled:!0},"Select your Audience type"),r.a.createElement("option",{value:"campus"},"All the campus"),r.a.createElement("option",{value:"school"},"Specific school"),r.a.createElement("option",{value:"department"},"Specific department"),r.a.createElement("option",{value:"class"},"Specific combination"))),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"target"},"Audience"),r.a.createElement("input",{type:"text",name:"target",onChange:function(e){return g(Object(i.a)(Object(i.a)({},b),{},{target:e.target.value}))},placeholder:"News Audience in abbreviation",required:!0})),r.a.createElement("div",{className:"form-control"},r.a.createElement("button",{type:"submit",className:"btn",disabled:b.loading},b.loading?r.a.createElement(w,null):"Create"))))},k=function(){var e,t=Object(n.useContext)(f),a=t.token,c=t.login,l=t.role;return Object(n.useEffect)((function(){if(!a){var e=JSON.parse(localStorage.getItem("userData"));return c(e)}}),[]),e=a,r.a.createElement("div",{className:"App"},r.a.createElement(o.a,null,r.a.createElement(r.a.Fragment,null,e&&r.a.createElement(S,null),r.a.createElement("main",{className:"page"},r.a.createElement(s.d,null,"admin"!==l&&r.a.createElement(s.a,{from:"/admin",to:"/",exact:!0}),"student"===l&&r.a.createElement(s.a,{from:"/create",to:"/",exact:!0}),!e&&r.a.createElement(s.a,{from:"/",to:"/auth",exact:!0}),!e&&r.a.createElement(s.a,{from:"/home",to:"/auth",exact:!0}),!e&&r.a.createElement(s.a,{from:"/create",to:"/auth",exact:!0}),e&&r.a.createElement(s.a,{from:"/",to:"/home",exact:!0}),e&&r.a.createElement(s.a,{from:"/auth",to:"/home",exact:!0}),"student"===l&&r.a.createElement(s.a,{from:"/create",to:"/home",exact:!0}),"student"===l&&r.a.createElement(s.a,{from:"/admin",to:"/home",exact:!0}),r.a.createElement(s.b,{path:"/auth",component:v,exact:!0}),r.a.createElement(s.b,{path:"/home",component:N,exact:!0}),r.a.createElement(s.b,{path:"/create",exact:!0},r.a.createElement(C,{role:l,token:e})),r.a.createElement(s.b,{path:"/admin",component:x,exact:!0}))))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(h,null,r.a.createElement(k,null))),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.e7c2ce64.chunk.js.map